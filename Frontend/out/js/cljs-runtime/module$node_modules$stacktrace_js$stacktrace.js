shadow$provide.module$node_modules$stacktrace_js$stacktrace=function(global,require,module,exports){(function(root,factory){"function"===typeof define&&define.amd?define("stacktrace",["error-stack-parser","stack-generator","stacktrace-gps"],factory):"object"===typeof exports?module.exports=factory(require("module$node_modules$error_stack_parser$error_stack_parser"),require("module$node_modules$stack_generator$stack_generator"),require("module$node_modules$stacktrace_gps$stacktrace_gps")):root.StackTrace=
factory(root.ErrorStackParser,root.StackGenerator,root.StackTraceGPS)})(this,function(ErrorStackParser,StackGenerator,StackTraceGPS){function _merge(first,second){var target={};[first,second].forEach(function(obj){for(var prop in obj)Object.prototype.hasOwnProperty.call(obj,prop)&&(target[prop]=obj[prop]);return target});return target}function _isShapedLikeParsableError(err){return err.stack||err["opera#sourceloc"]}function _filtered(stackframes,filter){return"function"===typeof filter?stackframes.filter(filter):
stackframes}var _options={filter:function(stackframe){return-1===(stackframe.functionName||"").indexOf("StackTrace$$")&&-1===(stackframe.functionName||"").indexOf("ErrorStackParser$$")&&-1===(stackframe.functionName||"").indexOf("StackTraceGPS$$")&&-1===(stackframe.functionName||"").indexOf("StackGenerator$$")},sourceCache:{}},_generateError=function(){try{throw Error();}catch(err){return err}};return{get:function(opts){var err=_generateError();return _isShapedLikeParsableError(err)?this.fromError(err,
opts):this.generateArtificially(opts)},getSync:function(opts){opts=_merge(_options,opts);var err=_generateError();err=_isShapedLikeParsableError(err)?ErrorStackParser.parse(err):StackGenerator.backtrace(opts);return _filtered(err,opts.filter)},fromError:function(error,opts){opts=_merge(_options,opts);var gps=new StackTraceGPS(opts);return new Promise(function(resolve$jscomp$0){var stackframes=_filtered(ErrorStackParser.parse(error),opts.filter);resolve$jscomp$0(Promise.all(stackframes.map(function(sf){return new Promise(function(resolve){function resolveOriginal(){resolve(sf)}
gps.pinpoint(sf).then(resolve,resolveOriginal)["catch"](resolveOriginal)})})))}.bind(this))},generateArtificially:function(opts){opts=_merge(_options,opts);var stackFrames=StackGenerator.backtrace(opts);"function"===typeof opts.filter&&(stackFrames=stackFrames.filter(opts.filter));return Promise.resolve(stackFrames)},instrument:function(fn,callback,errback,thisArg){if("function"!==typeof fn)throw Error("Cannot instrument non-function object");if("function"===typeof fn.__stacktraceOriginalFn)return fn;
var instrumented=function(){try{return this.get().then(callback,errback)["catch"](errback),fn.apply(thisArg||this,arguments)}catch(e){if(_isShapedLikeParsableError(e))this.fromError(e).then(callback,errback)["catch"](errback);throw e;}}.bind(this);instrumented.__stacktraceOriginalFn=fn;return instrumented},deinstrument:function(fn){if("function"!==typeof fn)throw Error("Cannot de-instrument non-function object");return"function"===typeof fn.__stacktraceOriginalFn?fn.__stacktraceOriginalFn:fn},report:function(stackframes,
url,errorMsg,requestOptions){return new Promise(function(resolve,reject){var req=new XMLHttpRequest;req.onerror=reject;req.onreadystatechange=function(){4===req.readyState&&(200<=req.status&&400>req.status?resolve(req.responseText):reject(Error("POST to "+url+" failed with status: "+req.status)))};req.open("post",url);req.setRequestHeader("Content-Type","application/json");if(requestOptions&&"object"===typeof requestOptions.headers){var headers=requestOptions.headers,header;for(header in headers)Object.prototype.hasOwnProperty.call(headers,
header)&&req.setRequestHeader(header,headers[header])}headers={stack:stackframes};void 0!==errorMsg&&null!==errorMsg&&(headers.message=errorMsg);req.send(JSON.stringify(headers))})}}})}
//# sourceMappingURL=module$node_modules$stacktrace_js$stacktrace.js.map
